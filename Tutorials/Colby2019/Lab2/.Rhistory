xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#56B1F7",limits=c(0, 10))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence)), mapping = aes(x=Salinity, y=Temperature, fill=Fluorescence)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#56B1F7",limits=c(0, 10))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#56B1F7",limits=c(0, 10))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#56B1F7",limits=c(0, 10))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#56B1F7",limits=c(0, 10))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_tile(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, fill=Fluorescence)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#56B1F7",limits=c(0, 10))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_tile(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 10))
v
<- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 10))
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 10))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 7.5))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 7.5), oob=squish)
library(scales)
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 7.5), oob=squish)
v
v2 = direct.label(v, list("top.pieces", colour="black")) + guides(colour = "colorbar")
v2
summary(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)  & !is.na(Temperature)))
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 1.5), oob=squish)
v2 = direct.label(v, list("top.pieces", colour="black")) + guides(colour = "colorbar")
v2
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Depth) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=Depth)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 100), oob=squish)
v2 = direct.label(v, list("top.pieces", colour="black")) + guides(colour = "colorbar")
v2
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Depth) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=Depth)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 110), oob=squish)
v2 = direct.label(v, list("top.pieces", colour="black")) + guides(colour = "colorbar")
v2
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Depth)), mapping = aes(x=Salinity, y=Temperature, color=Depth)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 110), oob=squish)
v2 = direct.label(v, list("top.pieces", colour="black")) + guides(colour = "colorbar")
v2
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Depth) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=Depth)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 50), oob=squish)
v2 = direct.label(v, list("top.pieces", colour="black")) + guides(colour = "colorbar")
v
v2
summary(subset(DATA,!is.na(Fluorescence) & !is.na(Salinity)  & !is.na(Temperature)))
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(PAR) & !is.na(Salinity)  & !is.na(Temperature)), mapping = aes(x=Salinity, y=Temperature, color=PAR)) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 40), oob=squish)
v2 = direct.label(v, list("top.pieces", colour="black")) + guides(colour = "colorbar")
v2
detach("package:directlabels", unload=TRUE)
library("directlabels")
help(tsdiag)
rho2 <- swRho(sal,temp,p)
rho[1:10]
rho2[1:10]
rho2 <- swRho(sal,pt,p)
rho2[1:10]
pt[1:10]
temp[1:10]
pt[100:110]
temp[100:110]
p[100:110]
p[50:60]
p[80:90]
p[200:210]
p[500:510]
p[400:410]
p[300:310]
p[380:390]
p[480:490]
p[450:460]
p[430:460]
p[420:460]
which(p>1000)
which(p>100)
which(p>90)
max(p)
max(z)
which.max(z)
p[48879]
which(p<-100)
which(p< -100)
which(p < -100)
which(p < -90)
p[48879] < -90
class(p)
mode(p)
as.integer(p[48879]) < -90
integer(p[48879]) < -90
p[48879]
p[48879]
p[48879]
z <- DATA$Depth
sal <- DATA$Salinity
temp <- DATA$Temperature
p <- gsw_z_from_p(z,43.8)
p[48879]
p[48879] < 90
p < 90
p < -90
which(p < -90)
p[25634:25650]
rho[25634:25650]
rho2[25634:25650]
SA[25634:25650]
CT[25634:25650]
temp[25634:25650]
sal[25634:25650]
SA <- gsw_SA_from_SP(sal,p,-69.50,43.85)
CT <- gsw_CT_from_t(SA,temp,p)
SA[25634:25650]
z <- DATA$Depth
sal <- DATA$Salinity
temp <- DATA$Temperature
p <- gsw_z_from_p(z,43.8)
SA <- gsw_SA_from_SP(sal,p,-69.50,43.85)
CT <- gsw_CT_from_t(SA,temp,p)
rho <- gsw_sigma0(SA,CT)
pt <- gsw_pt_from_CT(SA,CT)
DATA$pt <- pt
rho[25634:25650]
rho2[25634:25650]
rho2 <- swSigma0(sal,temp,p)
rho2[25634:25650]
rho[25634:25650]
rho2 <- swSigma0(sal,temp,p,-69.50,43.85)
rho2[25634:25650]
pt2 <- swTheta(sal,temp,p,-69.50,43.85)
pt[25634:25650]
pt2[25634:25650]
pt2 <- swTheta(sal,temp,p,-69.50,43.85,eos="gsw")
pt2 <- swTheta(sal,temp,-69.50,43.85,eos="gsw")
pt2 <- swTheta(salinity = sal,temperature = temp,pressure = p,longitude = -69.50,latitude = 43.85,eos="gsw")
pt2[25634:25650]
rho2 <- swSigma0(salinity = sal,temperature = temp,pressure = p,longitude = -69.50,latitude = 43.85,eos="gsw")
rho2[25634:25650]
rho[25634:25650]
rho2 <- swSigma0(salinity = sal,temperature = temp,pressure = p,longitude = -69.50,latitude = 43.85)
rho2[25634:25650]
pt <- swTheta(salinity = sal,temperature = temp,pressure = p,longitude = -69.50,latitude = 43.85,eos="gsw")
pt[25634:25650]
pt2[25634:25650]
pt <- swTheta(sal,temp,p,-69.50,43.85,eos="gsw")
pt <- swTheta(sal,temp,p,0,-69.50,43.85,eos="gsw")
pt[25634:25650]
z <- DATA$Depth
sal <- DATA$Salinity
temp <- DATA$Temperature
p <- gsw_z_from_p(z,43.85)
pt <- swTheta(sal,temp,p,0,-69.50,43.85,eos="gsw")
pt[25634:25650]
DATA$Density[25634:25650]
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="gsw")
sigma[25634:25650]
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="oceEOS")
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="unesco")
sigma[25634:25650]
SA <- gsw_SA_from_SP(sal,0,-69.50,43.85)
CT <- gsw_CT_from_pt(SA,temp)
temp2 <- gsw_t_from_CT(SA, CT, p)
sigma2 <- swSigma0(sal,temp2,p,-69.50,43.85,eos="gsw")
sigma2[25634:25650]
DATA$Density[25634:25650]
sigma[25634:25650]
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="gsw")
sigma[25634:25650]
mean(sigma-DATA$Density)
mean(sigma-DATA$Density,na.rm=T)
mean(sigma2-DATA$Density,na.rm=T)
sigma3 <- swSigma0(sal,temp2,p,-69.50,43.85,eos="unesco")
mean(sigma3-DATA$Density,na.rm=T)
mean((sigma3-DATA$Density)^2,na.rm=T)
mean((sigma2-DATA$Density)^2,na.rm=T)
mean((sigma-DATA$Density)^2,na.rm=T)
sigma2 <- swSigma0(sal,temp2,p,-69.50,43.85,eos="gsw")
mean((sigma2-DATA$Density)^2,na.rm=T)
z <- DATA$Depth
sal <- DATA$Salinity
temp <- DATA$Temperature
p <- gsw_z_from_p(z,43.85)
pt <- swTheta(sal,temp,p,0,-69.50,43.85,eos="gsw")
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="gsw")
sigma2 <- swSigma0(sal,temp,p,-69.50,43.85,eos="unesco")
sigma3 <- swSigma0(sal,temp2,p,-69.50,43.85,eos="gsw")
sigma4 <- swSigma0(sal,temp2,p,-69.50,43.85,eos="unesco")
mean((sigma-DATA$Density)^2,na.rm=T)
mean((sigma2-DATA$Density)^2,na.rm=T)
mean((sigma3-DATA$Density)^2,na.rm=T)
mean((sigma4-DATA$Density)^2,na.rm=T)
z <- DATA$Depth
sal <- DATA$Salinity
temp <- DATA$Temperature
p <- gsw_p_from_z(z,43.85)
pt <- swTheta(sal,temp,p,0,-69.50,43.85,eos="gsw")
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="gsw")
mean((sigma-DATA$Density)^2,na.rm=T)
SA <- gsw_SA_from_SP(sal,0,-69.50,43.85)
CT <- gsw_CT_from_pt(SA,temp)
temp2 <- gsw_t_from_CT(SA, CT, p)
sigma <- swSigma0(sal,temp2,p,-69.50,43.85,eos="gsw")
mean((sigma-DATA$Density)^2,na.rm=T)
mean((temp-temp2)^2,na.rm=T)
sigma[which(p < 100)]
mean((sigma[which(p < 100)]-DATA$Density[which(p < 100)])^2,na.rm=T)
z <- DATA$Depth
sal <- DATA$Salinity
temp <- DATA$Temperature
p <- gsw_p_from_z(z,43.85)
pt <- swTheta(sal,temp,p,0,-69.50,43.85,eos="gsw")
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="gsw")
mean((sigma[which(p < 100)]-DATA$Density[which(p < 100)])^2,na.rm=T)
SA <- gsw_SA_from_SP(sal,0,-69.50,43.85)
CT <- gsw_CT_from_pt(SA,temp)
temp2 <- gsw_t_from_CT(SA, CT, p)
sigma2 <- swSigma0(sal,temp2,p,-69.50,43.85,eos="gsw")
mean((sigma2[which(p < 100)]-DATA$Density[which(p < 100)])^2,na.rm=T)
mean((sigma2-DATA$Density)^2,na.rm=T)
mean((sigma-DATA$Density)^2,na.rm=T)
mean((temp-temp2)^2,na.rm=T)
z <- DATA$Depth
sal <- DATA$Salinity
temp <- DATA$Temperature
p <- gsw_p_from_z(z,43.85)
pt <- swTheta(sal,temp,p,0,-69.50,43.85,eos="gsw")
sigma <- swSigma0(sal,temp,p,eos="gsw")
z <- DATA$Depth
sal <- DATA$Salinity
temp <- DATA$Temperature
p <- gsw_p_from_z(z,43.85)
pt <- swTheta(sal,temp,p,0,-69.50,43.85,eos="gsw")
sigma <- swSigma0(sal,temp,p,0,0,eos="gsw")
mean((sigma-DATA$Density)^2,na.rm=T)
z <- DATA$Depth
sal <- DATA$Salinity
temp <- DATA$Temperature
p <- gsw_p_from_z(z,43.85)
pt <- swTheta(sal,temp,p,0,-69.50,43.85,eos="gsw")
sigma <- swSigma0(sal,temp,p,0,0,eos="unesco")
mean((sigma-DATA$Density)^2,na.rm=T)
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="unesco")
mean((sigma-DATA$Density)^2,na.rm=T)
sigma <- swSigma0(sal,temp,z,0,-69.50,43.85,eos="gsw")
sigma <- swSigma0(sal,temp,z,-69.50,43.85,eos="gsw")
mean((sigma-DATA$Density)^2,na.rm=T)
z
p <- gsw_p_from_z(-z,43.85)
p
sigma <- swSigma0(sal,temp,p,0,-69.50,43.85,eos="gsw")
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="gsw")
mean((sigma-DATA$Density)^2,na.rm=T)
p
p <- gsw_p_from_z(z,43.85)
p
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="gsw")
mean((sigma-DATA$Density)^2,na.rm=T)
p <- gsw_p_from_z(-z,43.85)
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="gsw")
mean((sigma-DATA$Density)^2,na.rm=T)
p <- gsw_p_from_z(-z,43.85)
pt <- swTheta(sal,temp,p,0,-69.50,43.85,eos="gsw")
SA <- gsw_SA_from_SP(sal,p,-69.50,43.85)
CT <- gsw_CT_from_pt(SA,temp)
temp2 <- gsw_t_from_CT(SA, CT, p)
sigma2 <- swSigma0(sal,temp2,p,-69.50,43.85,eos="gsw")
mean((sigma2-DATA$Density)^2,na.rm=T)
sigma2 <- swSigma0(sal,temp2,p,-69.50,43.85,eos="unesco")
mean((sigma2-DATA$Density)^2,na.rm=T)
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="unseco")
sigma <- swSigma0(sal,temp,p,-69.50,43.85,eos="unesco")
mean((sigma-DATA$Density)^2,na.rm=T)
p
z
# Calculate the potential temperature
z <- DATA$Depth
sal <- DATA$Salinity   # Practical Salinity [unitless]
temp <- DATA$Temperature    # in-situ Temperature [degC]
p <- gsw_p_from_z(-z,43.85)    # Pressure from height [dbar]
pt <- swTheta(sal,temp,p,0,-69.50,43.85,eos="gsw")    # Potential temperature [degC]
DATA$pt <- pt
# Create potential density contours
ptlim <- seq(-5,30,1)
sallim <- seq(29,34,.5)
saliso <- rep(sallim,length(ptlim))
ptiso <- rep(ptlim,length(sallim))
sigma <- swSigma0(saliso,ptiso,-69.50,43.85,eos="gsw")
isopycnals <- data.frame(sal = saliso, pt = ptiso, sigma = sigma)
# plot
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(DATA, mapping = aes(x=Salinity, y=Temperature)) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + xlab("Potential Temperature (deg C)")
v <- direct.label(v, list("top.pieces", colour="black"))
v
setwd('C:/Users/nmayot/Documents/PostDoc/teaching supervise/Colby 2019/Rbigelow/Tutorials/Colby2019/Lab2')
DATA<- read.csv("Colby_cruise_data_2012-2017-nico.csv", header=TRUE)
z <- DATA$Depth
sal <- DATA$Salinity
temp <- DATA$Temperature
p <- gsw_p_from_z(-z,43.85)
pt <- swTheta(sal,temp,p,0,-69.50,43.85,eos="gsw")
DATA$pt <- pt
ptlim <- seq(-5,30,1)
sallim <- seq(29,34,.5)
saliso <- rep(sallim,length(ptlim))
ptiso <- rep(ptlim,length(sallim))
sigma <- swSigma0(saliso,ptiso,-69.50,43.85,eos="gsw")
sigma <- swSigma0(saliso,ptiso,p,-69.50,43.85,eos="gsw")
p
length(p)
sigma <- swSigma0(saliso,ptiso,0,-69.50,43.85,eos="gsw")
isopycnals <- data.frame(sal = saliso, pt = ptiso, sigma = sigma)
# Calculate the potential temperature
z <- DATA$Depth
sal <- DATA$Salinity   # Practical Salinity [unitless]
temp <- DATA$Temperature    # in-situ Temperature [degC]
p <- gsw_p_from_z(-z,43.85)    # Pressure from height [dbar]
pt <- swTheta(sal,temp,p,0,-69.50,43.85,eos="gsw")    # Potential temperature [degC]
DATA$pt <- pt
# Create potential density contours
ptlim <- seq(-5,30,1)
sallim <- seq(29,34,.5)
saliso <- rep(sallim,length(ptlim))
ptiso <- rep(ptlim,length(sallim))
sigma <- swSigma0(saliso,ptiso,0,-69.50,43.85,eos="gsw")
isopycnals <- data.frame(sal = saliso, pt = ptiso, sigma = sigma)
# plot
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(DATA, mapping = aes(x=Salinity, y=Temperature)) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + xlab("Potential Temperature (deg C)")
v <- direct.label(v, list("top.pieces", colour="black"))
v
sigmaiso <- swSigma0(saliso,ptiso,0,-69.50,43.85,eos="gsw")
isopycnals <- data.frame(sal = saliso, pt = ptiso, sigma = sigmaiso)
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(x=sal, y=pt, sigma=sigmaiso, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(DATA, mapping = aes(x=Salinity, y=Temperature)) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + xlab("Potential Temperature (deg C)")
v <- direct.label(v, list("top.pieces", colour="black"))
v
sigmaiso <- swSigma0(saliso,ptiso,0,-69.50,43.85,eos="gsw")
isopycnals <- data.frame(sal = saliso, pt = ptiso, sigma = sigmaiso)
# plot
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(x=sal, y=pt, sigma=sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(DATA, mapping = aes(x=Salinity, y=Temperature)) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + xlab("Potential Temperature (deg C)")
v <- direct.label(v, list("top.pieces", colour="black"))
v
# plot
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(x=sal, y=pt, z=sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(DATA, mapping = aes(x=Salinity, y=Temperature)) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + xlab("Potential Temperature (deg C)")
v <- direct.label(v, list("top.pieces", colour="black"))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(x=sal, y=pt, z=sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(DATA, mapping = aes(x=Salinity, y=Temperature)) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + ylab("Potential Temperature (deg C)")
v <- direct.label(v, list("top.pieces", colour="black"))
v
v2 = direct.label(v, list("top.pieces", colour="black")) + guides(colour = "colorbar")
v2
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(x=sal, y=pt, z=sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(DATA, mapping = aes(x=Salinity, y=Temperature),size=1.2) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + ylab("Potential Temperature (deg C)")
v <- direct.label(v, list("top.pieces", colour="black"))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(x=sal, y=pt, z=sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(DATA, mapping = aes(x=Salinity, y=Temperature),size=.5) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + ylab("Potential Temperature (deg C)")
v <- direct.label(v, list("top.pieces", colour="black"))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(x=sal, y=pt, z=sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(DATA, mapping = aes(x=Salinity, y=Temperature),size=.8) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + ylab("Potential Temperature (deg C)")
v <- direct.label(v, list("top.pieces", colour="black"))
v
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = rho, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(DATA, mapping = aes(x=Salinity, y=Temperature, color=Fluorescence),size=.8) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#56B1F7",limits=c(0, 10))
v2 = direct.label(v, list("top.pieces", colour="black")) + guides(colour = "colorbar")
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(DATA, mapping = aes(x=Salinity, y=Temperature, color=Fluorescence),size=.8) +
xlim(29,34) + ylim(-5,30) + scale_colour_gradient(low = "#132B43", high = "#56B1F7",limits=c(0, 10))
v2 = direct.label(v, list("top.pieces", colour="black")) + guides(colour = "colorbar")
v2
# Create potential density contours
ptlim <- seq(-5,30,1)
sallim <- seq(29,34,.5)
saliso <- rep(sallim,length(ptlim))
ptiso <- rep(ptlim,length(sallim))
sigmaiso <- swSigma0(saliso,ptiso,0,-69.50,43.85,eos="gsw")
isopycnals <- data.frame(sal = saliso, pt = ptiso, sigma = sigmaiso)
# plot
v <- ggplot() +
geom_contour(isopycnals, mapping = aes(x=sal, y=pt, z=sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(DATA, mapping = aes(x=Salinity, y=Temperature)) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + ylab("Potential Temperature (deg C)")
v <- direct.label(v, list("top.pieces", colour="black"))
v
v2 <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + ylab("Potential Temperature (deg C)") +
scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 10), oob=squish)
v2 = direct.label(v2, list("top.pieces", colour="black")) + guides(colour = "colorbar")
v2
v2 = direct.label(v2, list("top.pieces", colour="black")) + guides(colour = "colorbar", colour = guide_legend("title"))
v2 <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + ylab("Potential Temperature (deg C)") +
scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 10), oob=squish)
v2 = direct.label(v2, list("top.pieces", colour="black")) + guides(colour = "colorbar", colour = guide_legend("title"))
v2
v2 <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + ylab("Potential Temperature (deg C)") +
scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 10), oob=squish)
v2 = direct.label(v2, list("top.pieces", colour="black")) + guides(colour = "colorbar") + guide_legend("Fluo")
v2
v2 <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + ylab("Potential Temperature (deg C)") +
scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 10), oob=squish)
v2 = direct.label(v2, list("top.pieces", colour="black")) + guides(colour = guide_colorbar(title ="Fluo"))
v2
v2 <- ggplot() +
geom_contour(isopycnals, mapping = aes(sal, pt, z = sigma, colour = ..level..),breaks = seq(17, 27,1),color="black") +
geom_point(subset(DATA,!is.na(Fluorescence)), mapping = aes(x=Salinity, y=Temperature, color=Fluorescence)) +
xlim(29,34) + ylim(-5,30) +
xlab("Practical Salinity") + ylab("Potential Temperature (deg C)") +
scale_colour_gradient(low = "#132B43", high = "#32CD32",limits=c(0, 10), oob=squish)
v2 = direct.label(v2, list("top.pieces", colour="black")) + guides(colour = guide_colorbar(title ="Fluorescence (mg/m^3)"))
v2
DF <- data.frame(x = c(1, 2, 3), y = c(0, 10, NA))
na.omit(DF)
