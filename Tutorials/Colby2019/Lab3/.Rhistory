ylab("Latitude") +
theme(legend.title = element_blank()) +
coastd
clus2 <- clus
# for the map
ggplot() +
# geom_tile(aes(x = lon, y = lat, fill = mbs)) +
geom_tile(aes(x = lon, y = lat, fill = factor(clus2))) +
scale_fill_manual(values = col[1:max(clus)], expand = c(0, 0)) +
coord_quickmap() +  # Prevents stretching when resizing
theme_bw() +
xlab("Longitude") +
ylab("Latitude") +
theme(legend.title = element_blank()) +
coastd
pred <- predict(pca, newdata=CHL[gp,])
pcs <- 3
centers <- apply(pred[,1:pcs],2,function(x) {aggregate(x,list(dataset$cluster),mean)[,2]})
climcmeans <- cmeans(pred[,1:pcs], centers[,1:pcs])
clus <- climcmeans$cluster
result <- data.frame(mbs,clus)
ggplot(result, aes(y=mbs, x = factor(clus))) + geom_boxplot()
clus2 <- clus
# for the map
ggplot() +
# geom_tile(aes(x = lon, y = lat, fill = mbs)) +
geom_tile(aes(x = lon, y = lat, fill = factor(clus2))) +
scale_fill_manual(values = col[1:max(clus)], expand = c(0, 0)) +
coord_quickmap() +  # Prevents stretching when resizing
theme_bw() +
xlab("Longitude") +
ylab("Latitude") +
theme(legend.title = element_blank()) +
coastd
clus2 <- dataset$cluster
# for the map
ggplot() +
# geom_tile(aes(x = lon, y = lat, fill = mbs)) +
geom_tile(aes(x = lon, y = lat, fill = factor(clus2))) +
scale_fill_manual(values = col[1:max(clus)], expand = c(0, 0)) +
coord_quickmap() +  # Prevents stretching when resizing
theme_bw() +
xlab("Longitude") +
ylab("Latitude") +
theme(legend.title = element_blank()) +
coastd
pred <- predict(pca, newdata=CHL[gp,])
pcs <- 5
centers <- apply(pred[,1:pcs],2,function(x) {aggregate(x,list(dataset$cluster),mean)[,2]})
climcmeans <- cmeans(pred[,1:pcs], centers[,1:pcs])
clus <- climcmeans$cluster
clus2 <- clus
# for the map
ggplot() +
# geom_tile(aes(x = lon, y = lat, fill = mbs)) +
geom_tile(aes(x = lon, y = lat, fill = factor(clus2))) +
scale_fill_manual(values = col[1:max(clus)], expand = c(0, 0)) +
coord_quickmap() +  # Prevents stretching when resizing
theme_bw() +
xlab("Longitude") +
ylab("Latitude") +
theme(legend.title = element_blank()) +
coastd
rm(list=ls()) # clear all variable
library(e1071)
library(fpc) # for clustering
folder <- "C:/Users/nmayot/Documents/PostDoc/data/satellite/MedOC4AD4/" # folder with data
filename <- "MedOC_clim_1997_2017_8D_9km_CHL_CoastFree.rdata" # Name of the dataset
load(file = paste(folder,filename,sep="")) # load dataset (row = pixels, column = variables)
CHL <- dataset$CHL_norm[,c(24:46,1:23)] # dataset to be cluterized
gp <- dataset$gp # pixel (observations) to be clusterized
tschl <- CHL[gp,]
# --- conduct PCA
pca <- prcomp(tschl, retx=TRUE, center=TRUE, scale=TRUE)
explvar <- round(pca$sdev^2/sum(pca$sdev^2)*100) # percent explained variance
# --- Save PCA results
dataset$pca <- pca
dataset$explvar <- explvar
# --- Determined threshold (of membership) with a cmeans on climatological dataset
pred <- predict(pca, newdata=CHL[gp,])
pcs <- 4
centers <- apply(pred[,1:pcs],2,function(x) {aggregate(x,list(dataset$cluster),mean)[,2]})
climcmeans <- cmeans(pred[,1:pcs], centers[,1:pcs])
climmbs <- apply(climcmeans$membership,1,max)
threshold <- aggregate(climmbs,list(climcmeans$cluster),function(x) {quantile(x,.25)})[,2]
# - - - Annual clustering
folder <- "C:/Users/nmayot/Documents/PostDoc/data/satellite/MedOC4AD4/" # folder with data
filename <- "MedOC_year_1998_2017_8D_9km_CHL_CoastFree.rdata" # Name of the dataset
load(file = paste(folder,filename,sep="")) # load dataset (row = pixels, column = variables)
y <- 9
gp <- dataset$gp[[y]]
pred <- predict(pca, newdata=dataset$CHL_norm[gp,,y])
a <- cmeans(pred[,1:pcs], centers[,1:pcs])
dataset$cluster2 <- a$cluster
# --- quick plots of the results
info <- dataset # dataset_seawifs #
clus <- info$cluster2
# gp <- info$gp
lon <- info$LON[gp]
lat <- info$LAT[gp]
col <- brewer.pal(max(clus), "RdBu")
med <- read.csv("C:/Users/nmayot/Documents/PostDoc/data/gshhg/gshhg_medit_i.csv") # file to draw the coast
coastd <- geom_polygon(data=med, aes(x=lon, y=lat), fill="black",colour=0)
# for the map
ggplot() +
geom_tile(aes(x = lon, y = lat, fill = factor(clus))) +
scale_fill_manual(values = col[1:max(clus)], expand = c(0, 0)) +
coord_quickmap() +  # Prevents stretching when resizing
theme_bw() +
xlab("Longitude") +
ylab("Latitude") +
theme(legend.title = element_blank()) +
coastd
yearmbs <- apply(a$membership,1,max)
gp <- gp[yearmbs > threshold[a$cluster]]
dataset$cluster2 <- a$cluster[yearmbs > threshold[a$cluster]]
# --- quick plots of the results
info <- dataset # dataset_seawifs #
clus <- info$cluster2
# gp <- info$gp
lon <- info$LON[gp]
lat <- info$LAT[gp]
col <- brewer.pal(max(clus), "RdBu")
med <- read.csv("C:/Users/nmayot/Documents/PostDoc/data/gshhg/gshhg_medit_i.csv") # file to draw the coast
coastd <- geom_polygon(data=med, aes(x=lon, y=lat), fill="black",colour=0)
# for the map
ggplot() +
geom_tile(aes(x = lon, y = lat, fill = factor(clus))) +
scale_fill_manual(values = col[1:max(clus)], expand = c(0, 0)) +
coord_quickmap() +  # Prevents stretching when resizing
theme_bw() +
xlab("Longitude") +
ylab("Latitude") +
theme(legend.title = element_blank()) +
coastd
threshold
y <- 2
gp <- dataset$gp[[y]]
pred <- predict(pca, newdata=dataset$CHL_norm[gp,,y])
a <- cmeans(pred[,1:pcs], centers[,1:pcs])
dataset$cluster2 <- a$cluster
# --- quick plots of the results
info <- dataset # dataset_seawifs #
clus <- info$cluster2
# gp <- info$gp
lon <- info$LON[gp]
lat <- info$LAT[gp]
col <- brewer.pal(max(clus), "RdBu")
med <- read.csv("C:/Users/nmayot/Documents/PostDoc/data/gshhg/gshhg_medit_i.csv") # file to draw the coast
coastd <- geom_polygon(data=med, aes(x=lon, y=lat), fill="black",colour=0)
# for the map
ggplot() +
geom_tile(aes(x = lon, y = lat, fill = factor(clus))) +
scale_fill_manual(values = col[1:max(clus)], expand = c(0, 0)) +
coord_quickmap() +  # Prevents stretching when resizing
theme_bw() +
xlab("Longitude") +
ylab("Latitude") +
theme(legend.title = element_blank()) +
coastd
yearmbs <- apply(a$membership,1,max)
gp <- gp[yearmbs > threshold[a$cluster]]
dataset$cluster2 <- a$cluster[yearmbs > threshold[a$cluster]]
# --- quick plots of the results
info <- dataset # dataset_seawifs #
clus <- info$cluster2
# gp <- info$gp
lon <- info$LON[gp]
lat <- info$LAT[gp]
col <- brewer.pal(max(clus), "RdBu")
med <- read.csv("C:/Users/nmayot/Documents/PostDoc/data/gshhg/gshhg_medit_i.csv") # file to draw the coast
coastd <- geom_polygon(data=med, aes(x=lon, y=lat), fill="black",colour=0)
# for the map
ggplot() +
geom_tile(aes(x = lon, y = lat, fill = factor(clus))) +
scale_fill_manual(values = col[1:max(clus)], expand = c(0, 0)) +
coord_quickmap() +  # Prevents stretching when resizing
theme_bw() +
xlab("Longitude") +
ylab("Latitude") +
theme(legend.title = element_blank()) +
coastd
# --- Determined threshold (of membership) with a cmeans on climatological dataset
pred <- predict(pca, newdata=CHL[gp,])
pcs <- 4
centers <- apply(pred[,1:pcs],2,function(x) {aggregate(x,list(dataset$cluster),mean)[,2]})
climcmeans <- cmeans(pred[,1:pcs], centers[,1:pcs])
climmbs <- apply(climcmeans$membership,1,max)
threshold <- aggregate(climmbs,list(climcmeans$cluster),function(x) {quantile(x,.1)})[,2]
y <- 2
gp <- dataset$gp[[y]]
pred <- predict(pca, newdata=dataset$CHL_norm[gp,,y])
a <- cmeans(pred[,1:pcs], centers[,1:pcs])
dataset$cluster2 <- a$cluster
yearmbs <- apply(a$membership,1,max)
gp <- gp[yearmbs > threshold[a$cluster]]
dataset$cluster2 <- a$cluster[yearmbs > threshold[a$cluster]]
# --- quick plots of the results
info <- dataset # dataset_seawifs #
clus <- info$cluster2
# gp <- info$gp
lon <- info$LON[gp]
lat <- info$LAT[gp]
col <- brewer.pal(max(clus), "RdBu")
med <- read.csv("C:/Users/nmayot/Documents/PostDoc/data/gshhg/gshhg_medit_i.csv") # file to draw the coast
coastd <- geom_polygon(data=med, aes(x=lon, y=lat), fill="black",colour=0)
# for the map
ggplot() +
geom_tile(aes(x = lon, y = lat, fill = factor(clus))) +
scale_fill_manual(values = col[1:max(clus)], expand = c(0, 0)) +
coord_quickmap() +  # Prevents stretching when resizing
theme_bw() +
xlab("Longitude") +
ylab("Latitude") +
theme(legend.title = element_blank()) +
coastd
y <- 9
gp <- dataset$gp[[y]]
pred <- predict(pca, newdata=dataset$CHL_norm[gp,,y])
a <- cmeans(pred[,1:pcs], centers[,1:pcs])
dataset$cluster2 <- a$cluster
yearmbs <- apply(a$membership,1,max)
gp <- gp[yearmbs > threshold[a$cluster]]
dataset$cluster2 <- a$cluster[yearmbs > threshold[a$cluster]]
# --- quick plots of the results
info <- dataset # dataset_seawifs #
clus <- info$cluster2
# gp <- info$gp
lon <- info$LON[gp]
lat <- info$LAT[gp]
col <- brewer.pal(max(clus), "RdBu")
med <- read.csv("C:/Users/nmayot/Documents/PostDoc/data/gshhg/gshhg_medit_i.csv") # file to draw the coast
coastd <- geom_polygon(data=med, aes(x=lon, y=lat), fill="black",colour=0)
# for the map
ggplot() +
geom_tile(aes(x = lon, y = lat, fill = factor(clus))) +
scale_fill_manual(values = col[1:max(clus)], expand = c(0, 0)) +
coord_quickmap() +  # Prevents stretching when resizing
theme_bw() +
xlab("Longitude") +
ylab("Latitude") +
theme(legend.title = element_blank()) +
coastd
# - - - Annual clustering
folder <- "C:/Users/nmayot/Documents/PostDoc/data/satellite/MedOC4AD4/" # folder with data
filename <- "MedOC_year_1998_2017_8D_9km_CHL_CoastFree.rdata" # Name of the dataset
load(file = paste(folder,filename,sep="")) # load dataset (row = pixels, column = variables)
# --- Save PCA results obtained from climatology
dataset$pca <- pca
dataset$centers <- centers
dataset$pcs <- pcs
dataset$threshold <- threshold
rm(list=ls()) # clear all variable
library(e1071)
library(fpc) # for clustering
# folder <- "C:/Users/nmayot/Documents/PostDoc/data/satellite/MedOC4AD4/" # folder with data
# filename <- "MedOC_clim_1997_2017_8D_9km_CHL_CoastFree.rdata" # Name of the dataset
# load(file = paste(folder,filename,sep="")) # load dataset (row = pixels, column = variables)
#
# CHL <- dataset$CHL_norm[,c(24:46,1:23)] # dataset to be cluterized
# gp <- dataset$gp # pixel (observations) to be clusterized
# tschl <- CHL[gp,]
#
# # --- conduct PCA
# pca <- prcomp(tschl, retx=TRUE, center=TRUE, scale=TRUE)
# explvar <- round(pca$sdev^2/sum(pca$sdev^2)*100) # percent explained variance
#
#
# # --- Save PCA results
# dataset$pca <- pca
# dataset$explvar <- explvar
#
#
# # --- Determined threshold (of membership) with a cmeans on climatological dataset
# pred <- predict(pca, newdata=CHL[gp,])
# pcs <- 4
# centers <- apply(pred[,1:pcs],2,function(x) {aggregate(x,list(dataset$cluster),mean)[,2]})
# climcmeans <- cmeans(pred[,1:pcs], centers[,1:pcs])
#
# climmbs <- apply(climcmeans$membership,1,max)
# threshold <- aggregate(climmbs,list(climcmeans$cluster),function(x) {quantile(x,.1)})[,2]
# - - - Annual clustering
folder <- "C:/Users/nmayot/Documents/PostDoc/data/satellite/MedOC4AD4/" # folder with data
filename <- "MedOC_year_1998_2017_8D_9km_CHL_CoastFree.rdata" # Name of the dataset
load(file = paste(folder,filename,sep="")) # load dataset (row = pixels, column = variables)
# # --- Save PCA results obtained from climatology
# dataset$pca <- pca
# dataset$centers <- centers
# dataset$pcs <- pcs
# dataset$threshold <- threshold
dim(dataset$CHL_norm)[3]
dataset$cluster <- array(NA,dim(dataset$CHL_norm)[1],dim(dataset$CHL_norm)[2])
dim(dataset$CHL_norm)[1],dim(dataset$CHL_norm)[2]
dim(dataset$CHL_norm)[1]
dim(dataset$CHL_norm)[2]
dataset$cluster <- array(NA,c(dim(dataset$CHL_norm)[1],dim(dataset$CHL_norm)[3]))
str(dataset)
rm(list=ls()) # clear all variable
library(e1071)
library(fpc) # for clustering
# folder <- "C:/Users/nmayot/Documents/PostDoc/data/satellite/MedOC4AD4/" # folder with data
# filename <- "MedOC_clim_1997_2017_8D_9km_CHL_CoastFree.rdata" # Name of the dataset
# load(file = paste(folder,filename,sep="")) # load dataset (row = pixels, column = variables)
#
# CHL <- dataset$CHL_norm[,c(24:46,1:23)] # dataset to be cluterized
# gp <- dataset$gp # pixel (observations) to be clusterized
# tschl <- CHL[gp,]
#
# # --- conduct PCA
# pca <- prcomp(tschl, retx=TRUE, center=TRUE, scale=TRUE)
# explvar <- round(pca$sdev^2/sum(pca$sdev^2)*100) # percent explained variance
#
#
# # --- Save PCA results
# dataset$pca <- pca
# dataset$explvar <- explvar
#
#
# # --- Determined threshold (of membership) with a cmeans on climatological dataset
# pred <- predict(pca, newdata=CHL[gp,])
# pcs <- 4
# centers <- apply(pred[,1:pcs],2,function(x) {aggregate(x,list(dataset$cluster),mean)[,2]})
# climcmeans <- cmeans(pred[,1:pcs], centers[,1:pcs])
#
# climmbs <- apply(climcmeans$membership,1,max)
# threshold <- aggregate(climmbs,list(climcmeans$cluster),function(x) {quantile(x,.1)})[,2]
# - - - Annual clustering
folder <- "C:/Users/nmayot/Documents/PostDoc/data/satellite/MedOC4AD4/" # folder with data
filename <- "MedOC_year_1998_2017_8D_9km_CHL_CoastFree.rdata" # Name of the dataset
load(file = paste(folder,filename,sep="")) # load dataset (row = pixels, column = variables)
# # --- Save PCA results obtained from climatology
# dataset$pca <- pca
# dataset$centers <- centers
# dataset$pcs <- pcs
# dataset$threshold <- threshold
# --- load pca results
pca <- dataset$pca
pcs <- dataset$pcs
centers <- dataset$centers
threshold <- dataset$threshold
# --- Annual cmeans
dataset$cluster <- array(NA,dim(dataset$CHL_norm)[1],dim(dataset$CHL_norm)[2])
dataset$mbs <- array(NA,dim(dataset$CHL_norm)[1],dim(dataset$CHL_norm)[2])
for (y in 1:dim(dataset$CHL_norm)[3]) {
# annual data modified with climatological pca coordinates
gp <- dataset$gp[[y]]
pred <- predict(pca, newdata=dataset$CHL_norm[gp,,y])
# annual data clusterized
a <- cmeans(pred[,1:pcs], centers[,1:pcs])
yearmbs <- apply(a$membership,1,max)
dataset$cluster[gp,y] <- a$cluster
dataset$mbs[gp,y] <- yearmbs
}
pca
dataset$pca
rm(list=ls()) # clear all variable
library(e1071)
library(fpc) # for clustering
folder <- "C:/Users/nmayot/Documents/PostDoc/data/satellite/MedOC4AD4/" # folder with data
filename <- "MedOC_clim_1997_2017_8D_9km_CHL_CoastFree.rdata" # Name of the dataset
load(file = paste(folder,filename,sep="")) # load dataset (row = pixels, column = variables)
CHL <- dataset$CHL_norm[,c(24:46,1:23)] # dataset to be cluterized
gp <- dataset$gp # pixel (observations) to be clusterized
tschl <- CHL[gp,]
# --- conduct PCA
pca <- prcomp(tschl, retx=TRUE, center=TRUE, scale=TRUE)
explvar <- round(pca$sdev^2/sum(pca$sdev^2)*100) # percent explained variance
# --- Save PCA results
dataset$pca <- pca
dataset$explvar <- explvar
# --- Determined threshold (of membership) with a cmeans on climatological dataset
pred <- predict(pca, newdata=CHL[gp,])
pcs <- 4
centers <- apply(pred[,1:pcs],2,function(x) {aggregate(x,list(dataset$cluster),mean)[,2]})
climcmeans <- cmeans(pred[,1:pcs], centers[,1:pcs])
climmbs <- apply(climcmeans$membership,1,max)
threshold <- aggregate(climmbs,list(climcmeans$cluster),function(x) {quantile(x,.1)})[,2]
# --- Save PCA results obtained from climatology
dataset$pca <- pca
dataset$centers <- centers
dataset$pcs <- pcs
dataset$threshold <- threshold
save(dataset, file = paste(folder,filename,sep=""))
rm(list=ls()) # clear all variable
library(e1071)
library(fpc) # for clustering
folder <- "C:/Users/nmayot/Documents/PostDoc/data/satellite/MedOC4AD4/" # folder with data
filename <- "MedOC_clim_1997_2017_8D_9km_CHL_CoastFree.rdata" # Name of the dataset
load(file = paste(folder,filename,sep="")) # load dataset (row = pixels, column = variables)
# CHL <- dataset$CHL_norm[,c(24:46,1:23)] # dataset to be cluterized
# gp <- dataset$gp # pixel (observations) to be clusterized
# tschl <- CHL[gp,]
#
# # --- conduct PCA
# pca <- prcomp(tschl, retx=TRUE, center=TRUE, scale=TRUE)
# explvar <- round(pca$sdev^2/sum(pca$sdev^2)*100) # percent explained variance
#
#
# # --- Save PCA results
# dataset$pca <- pca
# dataset$explvar <- explvar
#
#
# # --- Determined threshold (of membership) with a cmeans on climatological dataset
# pred <- predict(pca, newdata=CHL[gp,])
# pcs <- 4
# centers <- apply(pred[,1:pcs],2,function(x) {aggregate(x,list(dataset$cluster),mean)[,2]})
# climcmeans <- cmeans(pred[,1:pcs], centers[,1:pcs])
#
# climmbs <- apply(climcmeans$membership,1,max)
# threshold <- aggregate(climmbs,list(climcmeans$cluster),function(x) {quantile(x,.1)})[,2]
#
# # --- Save PCA results obtained from climatology
# dataset$pca <- pca
# dataset$centers <- centers
# dataset$pcs <- pcs
# dataset$threshold <- threshold
#
# save(dataset, file = paste(folder,filename,sep=""))
# --- load pca results
pca <- dataset$pca
pcs <- dataset$pcs
centers <- dataset$centers
threshold <- dataset$threshold
# - - - Annual clustering
folder <- "C:/Users/nmayot/Documents/PostDoc/data/satellite/MedOC4AD4/" # folder with data
filename <- "MedOC_year_1998_2017_8D_9km_CHL_CoastFree.rdata" # Name of the dataset
load(file = paste(folder,filename,sep="")) # load dataset (row = pixels, column = variables)
# --- Annual cmeans
dataset$cluster <- array(NA,dim(dataset$CHL_norm)[1],dim(dataset$CHL_norm)[2])
dataset$mbs <- array(NA,dim(dataset$CHL_norm)[1],dim(dataset$CHL_norm)[2])
for (y in 1:dim(dataset$CHL_norm)[3]) {
# annual data modified with climatological pca coordinates
gp <- dataset$gp[[y]]
pred <- predict(pca, newdata=dataset$CHL_norm[gp,,y])
# annual data clusterized
a <- cmeans(pred[,1:pcs], centers[,1:pcs])
yearmbs <- apply(a$membership,1,max)
dataset$cluster[gp,y] <- a$cluster
dataset$mbs[gp,y] <- yearmbs
}
# --- Annual cmeans
dataset$cluster <- array(NA,c(dim(dataset$CHL_norm)[1],dim(dataset$CHL_norm)[2]))
dataset$mbs <- array(NA,c(dim(dataset$CHL_norm)[1],dim(dataset$CHL_norm)[2]))
for (y in 1:dim(dataset$CHL_norm)[3]) {
# annual data modified with climatological pca coordinates
gp <- dataset$gp[[y]]
pred <- predict(pca, newdata=dataset$CHL_norm[gp,,y])
# annual data clusterized
a <- cmeans(pred[,1:pcs], centers[,1:pcs])
yearmbs <- apply(a$membership,1,max)
dataset$cluster[gp,y] <- a$cluster
dataset$mbs[gp,y] <- yearmbs
}
test <- apply(dataset$cluster, 1, function(x) {uniqx <- unique(x); uniqx[which.max(tabulate(match(x, uniqx)))]})
test
test[!is.na(test)]
[!is.na(test)
!is.na(test)
which(!is.na(test))
which(!is.na(dataset$cluster[,1]))
x <- dataset$cluster[20546,]
x
uniqx <- unique(x)
uniqx
uniqx <- unique(x,na.rm=T)
uniqx
match(x, uniqx)
x
# --- Annual cmeans
dataset$cluster <- array(NA,c(dim(dataset$CHL_norm)[1],dim(dataset$CHL_norm)[3]))
dataset$mbs <- array(NA,c(dim(dataset$CHL_norm)[1],dim(dataset$CHL_norm)[3]))
for (y in 1:dim(dataset$CHL_norm)[3]) {
# annual data modified with climatological pca coordinates
gp <- dataset$gp[[y]]
pred <- predict(pca, newdata=dataset$CHL_norm[gp,,y])
# annual data clusterized
a <- cmeans(pred[,1:pcs], centers[,1:pcs])
yearmbs <- apply(a$membership,1,max)
dataset$cluster[gp,y] <- a$cluster
dataset$mbs[gp,y] <- yearmbs
}
test <- apply(dataset$cluster, 1, function(x) {uniqx <- unique(x); uniqx[which.max(tabulate(match(x, uniqx)))]})
test <- apply(dataset$cluster, 1, function(x) {uniqx <- unique(x); uniqx[which.max(tabulate(match(x, uniqx)))]})
test
which(!is.na(test))
gp<-which(!is.na(test))
clus<-test[gp]
lon <- dataset$LON[gp]
lat <- dataset$LAT[gp]
med <- read.csv("C:/Users/nmayot/Documents/PostDoc/data/gshhg/gshhg_medit_i.csv") # file to draw the coast
coastd <- geom_polygon(data=med, aes(x=lon, y=lat), fill="black",colour=0)
col <- brewer.pal(max(clus), "RdBu")
clus2 <- clus
# for the map
ggplot() +
# geom_tile(aes(x = lon, y = lat, fill = mbs)) +
geom_tile(aes(x = lon, y = lat, fill = factor(clus2))) +
scale_fill_manual(values = col[1:max(clus)], expand = c(0, 0)) +
coord_quickmap() +  # Prevents stretching when resizing
theme_bw() +
xlab("Longitude") +
ylab("Latitude") +
theme(legend.title = element_blank()) +
coastd
setwd("C:/Users/nmayot/Documents/PostDoc/teaching supervise/Colby 2019/Rbigelow/Tutorials/Colby2019/Lab3")
discreteDATA <- read.csv('Colby_discrete_data_2016.csv')
library(ggplot2)
library(gridExtra)
# At which depth do we have data?
unique(discreteDATA$Depth)
str(discreteDATA)
